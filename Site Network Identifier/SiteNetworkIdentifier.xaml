<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Site Network Identifier" Height="700" Width="1000">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TabControl x:Name="MainTabControl" Grid.Row="0">
            <!-- Lookup Site Tab -->
                    <TabItem Header="Lookup Site">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <GroupBox Header="Site Lookup" Grid.Row="0" Margin="0,0,0,10">
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Label Content="Site Code/Name to Lookup:" Grid.Row="0" Grid.Column="0"/>
                                    <TextBox x:Name="txtSiteLookup" Grid.Row="0" Grid.Column="1" Margin="0,2,5,2"/>
                                    <Button x:Name="btnLookupSite" Content="Lookup" Grid.Row="0" Grid.Column="2" Margin="0,2,0,2" Padding="10,3"/>
                                </Grid>
                            </GroupBox>
                            <GroupBox Header="Site Details" Grid.Row="1" x:Name="grpSiteLookupResults">
                                <ScrollViewer Margin="5" VerticalScrollBarVisibility="Auto">
                                    <StackPanel x:Name="stkSiteDetails" Margin="5">
                                        <!-- Site details will be populated dynamically -->
                                    </StackPanel>
                                </ScrollViewer>
                            </GroupBox>
                        </Grid>
                    </TabItem>

            <!-- Manage Sites Tab -->
            <TabItem Header="Manage Sites">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Sub-TabControl for Site Management -->
                    <TabControl x:Name="SiteManagementTabControl" Grid.Row="0" Height="400" Margin="0,0,0,10">
                       <!-- 1. Basic Info Tab -->
                        <TabItem Header="Basic Info">
                            <Grid Margin="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <Label Content="Site Code:" Grid.Row="0" Grid.Column="0"/>
                                <TextBox x:Name="txtSiteCode" Grid.Row="0" Grid.Column="1" Margin="0,2,0,2"/>
                                
                                <Label Content="Site Subnet:" Grid.Row="1" Grid.Column="0"/>
                                <TextBox x:Name="txtSiteSubnet" Grid.Row="1" Grid.Column="1" Margin="0,2,0,2" 
                                         ToolTip="Enter subnet like 10.107.0.0 to auto-populate VLANs"/>
                                
                                <Label Content="Site Subnet Code:" Grid.Row="2" Grid.Column="0"/>
                                <TextBox x:Name="txtSiteSubnetCode" Grid.Row="2" Grid.Column="1" Margin="0,2,0,2"/>
                                
                                <Label Content="Site Name:" Grid.Row="3" Grid.Column="0"/>
                                <TextBox x:Name="txtSiteName" Grid.Row="3" Grid.Column="1" Margin="0,2,0,2"/>
                                
                                <Label Content="Site Address:" Grid.Row="4" Grid.Column="0"/>
                                <TextBox x:Name="txtSiteAddress" Grid.Row="4" Grid.Column="1" Margin="0,2,0,2"/>
                                
                                <Label Content="Main Contact Name:" Grid.Row="5" Grid.Column="0"/>
                                <TextBox x:Name="txtMainContactName" Grid.Row="5" Grid.Column="1" Margin="0,2,0,2"/>
                                
                                <Label Content="Main Contact Phone:" Grid.Row="6" Grid.Column="0"/>
                                <TextBox x:Name="txtMainContactPhone" Grid.Row="6" Grid.Column="1" Margin="0,2,0,2"/>
                                
                                <Label Content="Second Contact Name:" Grid.Row="7" Grid.Column="0"/>
                                <TextBox x:Name="txtSecondContactName" Grid.Row="7" Grid.Column="1" Margin="0,2,0,2"/>
                                
                                <Label Content="Second Contact Phone:" Grid.Row="8" Grid.Column="0"/>
                                <TextBox x:Name="txtSecondContactPhone" Grid.Row="8" Grid.Column="1" Margin="0,2,0,2"/>
                            </Grid>
                        </TabItem>

                        <!-- 2. Switches Tab -->
                        <TabItem Header="Switches">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Grid Margin="10">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Number of Switches - VERTICAL Layout (label above ComboBox) -->
                                    <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,15">
                                        <Label Content="Number of Switches:"/>
                                        <ComboBox x:Name="cmbSwitchCount" Width="100" HorizontalAlignment="Left" SelectedIndex="-1">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                            <ComboBoxItem Content="10"/>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <!-- Switch Panels Container - Changed from StackPanel to Grid for 2-column layout -->
                                    <Grid x:Name="stkSwitches" Grid.Row="1">
                                        <!-- Grid rows and columns will be added dynamically by PowerShell -->
                                    </Grid>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>

                        <!-- 3. Access Points Tab -->
                        <TabItem Header="Access Points">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Grid Margin="10">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Number of Access Points - VERTICAL Layout -->
                                    <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,15">
                                        <Label Content="Number of Access Points:"/>
                                        <ComboBox x:Name="cmbAPCount" Width="100" HorizontalAlignment="Left" SelectedIndex="-1">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                            <ComboBoxItem Content="10"/>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <!-- Access Points Panels Container -->
                                    <Grid x:Name="stkAccessPoints" Grid.Row="1">
                                        <!-- Grid rows and columns will be added dynamically by PowerShell -->
                                    </Grid>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>

                        <!-- 4. Firewall Tab -->
                        <TabItem Header="Firewall">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Grid Margin="10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <Label Content="Management IP:" Grid.Row="0" Grid.Column="0"/>
                                    <TextBox x:Name="txtFirewallIP" Grid.Row="0" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="Name:" Grid.Row="1" Grid.Column="0"/>
                                    <TextBox x:Name="txtFirewallName" Grid.Row="1" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="Version:" Grid.Row="2" Grid.Column="0"/>
                                    <TextBox x:Name="txtFirewallVersion" Grid.Row="2" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="Serial Number:" Grid.Row="3" Grid.Column="0"/>
                                    <TextBox x:Name="txtFirewallSN" Grid.Row="3" Grid.Column="1" Margin="0,2,0,2"/>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>

                        <!-- 5. Primary Circuit Tab -->
                        <TabItem Header="Primary Circuit">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Grid Margin="10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Left Column - Circuit Info -->
                                    <Grid Grid.Column="0" Margin="0,0,10,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <Label Content="Vendor:" Grid.Row="0" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryVendor" Grid.Row="0" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="Circuit Type:" Grid.Row="1" Grid.Column="0"/>
                                        <ComboBox x:Name="cmbPrimaryCircuitType" Grid.Row="1" Grid.Column="1" Margin="0,2,0,2">
                                            <ComboBoxItem Content="Fiber"/>
                                            <ComboBoxItem Content="Cable"/>
                                            <ComboBoxItem Content="GPON Fiber"/>
                                        </ComboBox>
                                        
                                        <!-- GPON Fields - appear right after Circuit Type -->
                                        <StackPanel x:Name="stkPrimaryGPON" Grid.Row="2" Grid.ColumnSpan="2" Orientation="Vertical" Margin="0,5,0,5" Visibility="Collapsed">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <Label Content="PPPoE Username:" Grid.Row="0" Grid.Column="0"/>
                                                <TextBox x:Name="txtPrimaryPPPoEUsername" Grid.Row="0" Grid.Column="1" Margin="0,2,0,2"/>
                                                <Label Content="PPPoE Password:" Grid.Row="1" Grid.Column="0"/>
                                                <TextBox x:Name="txtPrimaryPPPoEPassword" Grid.Row="1" Grid.Column="1" Margin="0,2,0,2"/>
                                            </Grid>
                                        </StackPanel>
                                        
                                        <Label Content="Circuit ID:" Grid.Row="3" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryCircuitID" Grid.Row="3" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="Download Speed:" Grid.Row="4" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryDownloadSpeed" Grid.Row="4" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="Upload Speed:" Grid.Row="5" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryUploadSpeed" Grid.Row="5" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="IP Address:" Grid.Row="6" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryIPAddress" Grid.Row="6" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="Subnet Mask:" Grid.Row="7" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimarySubnetMask" Grid.Row="7" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="Default Gateway:" Grid.Row="8" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryDefaultGateway" Grid.Row="8" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="DNS 1:" Grid.Row="9" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryDNS1" Grid.Row="9" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="DNS 2:" Grid.Row="10" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryDNS2" Grid.Row="10" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="Router Model:" Grid.Row="11" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryRouterModel" Grid.Row="11" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="Router Name:" Grid.Row="12" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryRouterName" Grid.Row="12" Grid.Column="1" Margin="0,2,0,2"/>
                                        
                                        <Label Content="Router S/N:" Grid.Row="13" Grid.Column="0"/>
                                        <TextBox x:Name="txtPrimaryRouterSN" Grid.Row="13" Grid.Column="1" Margin="0,2,0,2"/>
                                    </Grid>
                                    
                                    <!-- Right Column - Modem Section -->
                                    <Grid Grid.Column="1">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        
                                        <CheckBox x:Name="chkPrimaryHasModem" Content="Site has Modem" Grid.Row="0" Margin="0,0,0,10"/>
                                        
                                        <StackPanel x:Name="stkPrimaryModem" Grid.Row="1" Orientation="Vertical">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <Label Content="Modem Model:" Grid.Row="0" Grid.Column="0"/>
                                                <TextBox x:Name="txtPrimaryModemModel" Grid.Row="0" Grid.Column="1" Margin="0,2,0,2"/>
                                                
                                                <Label Content="Modem Name:" Grid.Row="1" Grid.Column="0"/>
                                                <TextBox x:Name="txtPrimaryModemName" Grid.Row="1" Grid.Column="1" Margin="0,2,0,2"/>
                                                
                                                <Label Content="Modem S/N:" Grid.Row="2" Grid.Column="0"/>
                                                <TextBox x:Name="txtPrimaryModemSN" Grid.Row="2" Grid.Column="1" Margin="0,2,0,2"/>
                                            </Grid>
                                        </StackPanel>
                                    </Grid>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>

                        <!-- 6. Backup Circuit Tab -->
                        <TabItem Header="Backup Circuit">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Grid Margin="10">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <CheckBox x:Name="chkHasBackupCircuit" Content="Site has Backup Circuit" Grid.Row="0" Margin="0,0,0,10"/>
                                    
                                    <Grid x:Name="grdBackupCircuit" Grid.Row="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Left Column - Circuit Info -->
                                        <Grid Grid.Column="0" Margin="0,0,10,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <Label Content="Vendor:" Grid.Row="0" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupVendor" Grid.Row="0" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="Circuit Type:" Grid.Row="1" Grid.Column="0"/>
                                            <ComboBox x:Name="cmbBackupCircuitType" Grid.Row="1" Grid.Column="1" Margin="0,2,0,2">
                                                <ComboBoxItem Content="Fiber"/>
                                                <ComboBoxItem Content="Cable"/>
                                                <ComboBoxItem Content="GPON Fiber"/>
                                            </ComboBox>
                                            
                                            <!-- GPON Fields - appear right after Circuit Type -->
                                            <StackPanel x:Name="stkBackupGPON" Grid.Row="2" Grid.ColumnSpan="2" Orientation="Vertical" Margin="0,5,0,5" Visibility="Collapsed">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Label Content="PPPoE Username:" Grid.Row="0" Grid.Column="0"/>
                                                    <TextBox x:Name="txtBackupPPPoEUsername" Grid.Row="0" Grid.Column="1" Margin="0,2,0,2"/>
                                                    <Label Content="PPPoE Password:" Grid.Row="1" Grid.Column="0"/>
                                                    <TextBox x:Name="txtBackupPPPoEPassword" Grid.Row="1" Grid.Column="1" Margin="0,2,0,2"/>
                                                </Grid>
                                            </StackPanel>
                                            
                                            <Label Content="Circuit ID:" Grid.Row="3" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupCircuitID" Grid.Row="3" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="Download Speed:" Grid.Row="4" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupDownloadSpeed" Grid.Row="4" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="Upload Speed:" Grid.Row="5" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupUploadSpeed" Grid.Row="5" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="IP Address:" Grid.Row="6" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupIPAddress" Grid.Row="6" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="Subnet Mask:" Grid.Row="7" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupSubnetMask" Grid.Row="7" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="Default Gateway:" Grid.Row="8" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupDefaultGateway" Grid.Row="8" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="DNS 1:" Grid.Row="9" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupDNS1" Grid.Row="9" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="DNS 2:" Grid.Row="10" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupDNS2" Grid.Row="10" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="Router Model:" Grid.Row="11" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupRouterModel" Grid.Row="11" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="Router Name:" Grid.Row="12" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupRouterName" Grid.Row="12" Grid.Column="1" Margin="0,2,0,2"/>
                                            
                                            <Label Content="Router S/N:" Grid.Row="13" Grid.Column="0"/>
                                            <TextBox x:Name="txtBackupRouterSN" Grid.Row="13" Grid.Column="1" Margin="0,2,0,2"/>
                                        </Grid>
                                        
                                        <!-- Right Column - Modem Section -->
                                        <Grid Grid.Column="1">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            
                                            <CheckBox x:Name="chkBackupHasModem" Content="Site has Modem" Grid.Row="0" Margin="0,0,0,10"/>
                                            
                                            <StackPanel x:Name="stkBackupModem" Grid.Row="1" Orientation="Vertical">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    
                                                    <Label Content="Modem Model:" Grid.Row="0" Grid.Column="0"/>
                                                    <TextBox x:Name="txtBackupModemModel" Grid.Row="0" Grid.Column="1" Margin="0,2,0,2"/>
                                                    
                                                    <Label Content="Modem Name:" Grid.Row="1" Grid.Column="0"/>
                                                    <TextBox x:Name="txtBackupModemName" Grid.Row="1" Grid.Column="1" Margin="0,2,0,2"/>
                                                    
                                                    <Label Content="Modem S/N:" Grid.Row="2" Grid.Column="0"/>
                                                    <TextBox x:Name="txtBackupModemSN" Grid.Row="2" Grid.Column="1" Margin="0,2,0,2"/>
                                                </Grid>
                                            </StackPanel>
                                        </Grid>
                                    </Grid>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>

                        <!-- 7. VLANs Tab -->
                        <TabItem Header="VLANs">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Grid Margin="10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <Label Content="VLAN 100 - Servers:" Grid.Row="0" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan100" Grid.Row="0" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 101 - Network:" Grid.Row="1" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan101" Grid.Row="1" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 102 - User 1:" Grid.Row="2" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan102" Grid.Row="2" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 103 - User 2:" Grid.Row="3" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan103" Grid.Row="3" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 104 - VOIP:" Grid.Row="4" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan104" Grid.Row="4" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 105 - Wi-Fi Corp:" Grid.Row="5" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan105" Grid.Row="5" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 106 - Wi-Fi BYOD:" Grid.Row="6" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan106" Grid.Row="6" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 107 - Wi-Fi Guest:" Grid.Row="7" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan107" Grid.Row="7" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 108 - Spare:" Grid.Row="8" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan108" Grid.Row="8" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 109 - DMZ:" Grid.Row="9" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan109" Grid.Row="9" Grid.Column="1" Margin="0,2,0,2"/>
                                    
                                    <Label Content="VLAN 110 - CCTV:" Grid.Row="10" Grid.Column="0"/>
                                    <TextBox x:Name="txtVlan110" Grid.Row="10" Grid.Column="1" Margin="0,2,0,2"/>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>

                        <!-- 8. CCTV Tab -->
                        <TabItem Header="CCTV">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Grid Margin="10">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Number of CCTV Cameras - VERTICAL Layout -->
                                    <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,15">
                                        <Label Content="Number of CCTV Cameras:"/>
                                        <ComboBox x:Name="cmbCCTVCount" Width="100" HorizontalAlignment="Left" SelectedIndex="-1">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                            <ComboBoxItem Content="10"/>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <!-- CCTV Panels Container -->
                                    <Grid x:Name="stkCCTV" Grid.Row="1">
                                        <!-- Grid rows and columns will be added dynamically by PowerShell -->
                                    </Grid>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>

                        <!-- 9. UPS Tab -->
                        <TabItem Header="UPS">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Grid Margin="10">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Number of UPS - VERTICAL Layout -->
                                    <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,15">
                                        <Label Content="Number of UPS:"/>
                                        <ComboBox x:Name="cmbUPSCount" Width="100" HorizontalAlignment="Left" SelectedIndex="-1">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <!-- UPS Panels Container -->
                                    <Grid x:Name="stkUPS" Grid.Row="1">
                                        <!-- Grid rows and columns will be added dynamically by PowerShell -->
                                    </Grid>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>
                    </TabControl>

                    <!-- 10. Printer Tab -->
                <TabItem Header="Printer">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Number of Printers - VERTICAL Layout -->
                            <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,15">
                                <Label Content="Number of Printers:"/>
                                <ComboBox x:Name="cmbPrinterCount" Width="100" HorizontalAlignment="Left" SelectedIndex="-1">
                                    <ComboBoxItem Content="0"/>
                                    <ComboBoxItem Content="1"/>
                                    <ComboBoxItem Content="2"/>
                                    <ComboBoxItem Content="3"/>
                                    <ComboBoxItem Content="4"/>
                                    <ComboBoxItem Content="5"/>
                                    <ComboBoxItem Content="6"/>
                                    <ComboBoxItem Content="7"/>
                                    <ComboBoxItem Content="8"/>
                                    <ComboBoxItem Content="9"/>
                                    <ComboBoxItem Content="10"/>
                                </ComboBox>
                            </StackPanel>
                            
                            <!-- Printer Panels Container -->
                            <Grid x:Name="stkPrinter" Grid.Row="1">
                                <!-- Grid rows and columns will be added dynamically by PowerShell -->
                            </Grid>
                        </Grid>
                    </ScrollViewer>
                </TabItem>
                    
                    <!-- Add Site Button -->
                    <Grid Grid.Row="1" Margin="0,0,0,10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,0,0,10">
                            <Button x:Name="btnAddSite" Content="Add Site" Padding="15,5" Margin="0,0,10,0"/>
                            <Button x:Name="btnClearForm" Content="Clear Form" Padding="15,5"/>
                        </StackPanel>
                        
                        
                        <!-- Search Sites -->
                        <GroupBox Header="Search Sites" Grid.Row="1" Margin="0,0,0,10">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Label Content="Search:" Grid.Column="0"/>
                                <TextBox x:Name="txtSearchSites" Grid.Column="1" Margin="5,2,5,2"/>
                                <Button x:Name="btnClearSearchSites" Content="Clear" Grid.Column="2" Padding="10,3"/>
                            </Grid>
                        </GroupBox>
                        
                        <!-- Sites DataGrid -->
                        <DataGrid x:Name="dgSites" Grid.Row="2" AutoGenerateColumns="False"
                                  IsReadOnly="True" SelectionMode="Extended" Margin="0,0,0,10"
                                  CanUserAddRows="False">
                            <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding ID}" IsReadOnly="True" Width="40"/>
                            <DataGridTextColumn Header="Site Code" Binding="{Binding SiteCode}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Site Name" Binding="{Binding SiteName}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Subnet Code" Binding="{Binding SiteSubnetCode}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Address" Binding="{Binding SiteAddress}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Main Contact" Binding="{Binding MainContactName}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Main Phone" Binding="{Binding MainContactPhoneFormatted}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Switch 1 IP" Binding="{Binding Switch1IP}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Switch 1 Name" Binding="{Binding Switch1Name}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Firewall IP" Binding="{Binding FirewallIP}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Primary Vendor" Binding="{Binding PrimaryVendor}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Primary IP" Binding="{Binding PrimaryCircuitIP}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Primary DOWN Speed" Binding="{Binding PrimaryDownloadSpeed}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Primary UP Speed" Binding="{Binding PrimaryUploadSpeed}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Backup Vendor" Binding="{Binding BackupVendor}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Backup IP" Binding="{Binding BackupCircuitIP}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Backup DOWN Speed" Binding="{Binding BackupDownloadSpeed}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="Backup UP Speed" Binding="{Binding BackupUploadSpeed}" IsReadOnly="True" Width="Auto"/>
                            <DataGridTextColumn Header="APs" Binding="{Binding APCount}" IsReadOnly="True" Width="45"/>
                            <DataGridTextColumn Header="CCTV" Binding="{Binding CCTVCount}" IsReadOnly="True" Width="45"/>
                            <DataGridTextColumn Header="UPS" Binding="{Binding UPSCount}" IsReadOnly="True" Width="45"/>
                        </DataGrid.Columns>
                        </DataGrid>
                    </Grid> 
                    
                    <!-- Action Buttons and Status -->
                    <Grid Grid.Row="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,0,0,10">
                            <Button x:Name="btnEditSite" Content="Edit Selected" Padding="10,3" Margin="0,0,10,0"/>
                            <Button x:Name="btnDeleteSite" Content="Delete Selected" Padding="10,3"/>
                        </StackPanel>
                        <GroupBox Header="Status" Grid.Row="1">
                            <TextBlock x:Name="txtBlkSiteStatus" TextWrapping="Wrap" Margin="5"/>
                        </GroupBox>
                    </Grid>
                </Grid>
            </TabItem>

            <!-- Import/Export Tab -->
            <TabItem Header="Import/Export">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <GroupBox Header="Import/Export Sites" Grid.Row="0">
                        <Grid Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="10"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <GroupBox Header="Import Sites from Excel" Grid.Row="0">
                                <Grid Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0" Margin="0,0,0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="txtSiteCsvFilePath" Grid.Column="0" IsReadOnly="True" Margin="0,0,5,0"/>
                                        <Button x:Name="btnBrowseSiteCsv" Content="Browse..." Grid.Column="1" Padding="10,3"/>
                                    </Grid>
                                    <Button x:Name="btnImportSiteCsv" Content="Import" Grid.Row="1"
                                            HorizontalAlignment="Left" Padding="10,3"/>
                                </Grid>
                            </GroupBox>
                            <GroupBox Header="Export Sites to Excel" Grid.Row="2">
                                <Button x:Name="btnExportSiteCsv" Content="Export" Padding="10,3" Margin="0,5,0,0"
                                        HorizontalAlignment="Left"/>
                            </GroupBox>
                        </Grid>
                    </GroupBox>
                    <StackPanel x:Name="pnlSiteImportProgress" Grid.Row="1" Margin="5">
                        <ProgressBar x:Name="pbSiteImportProgress" Height="20" Minimum="0" Maximum="100"/>
                        <TextBlock x:Name="txtSiteProgressStatus" Margin="0,5,0,0" FontWeight="Bold"/>
                        <TextBlock x:Name="txtSiteProgressDetails" Margin="0,2,0,0" FontStyle="Italic"/>
                    </StackPanel>
                    <GroupBox Header="Import/Export Status" Grid.Row="2">
                        <TextBlock x:Name="txtBlkSiteImportStatus" TextWrapping="Wrap" Margin="5"/>
                    </GroupBox>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <Border x:Name="SiteStatusBar" Grid.Row="1" Background="LightGray" BorderBrush="Gray" BorderThickness="0,1,0,0">
            <StatusBar Background="Transparent">
                <StatusBarItem>
                    <TextBlock x:Name="txtStatusBarSites" Text="Total Sites: 0"/>
                </StatusBarItem>
                <Separator/>
                <StatusBarItem>
                    <TextBlock x:Name="txtStatusBarSiteSelected" Text="Selected: None"/>
                </StatusBarItem>
            </StatusBar>
        </Border>
    </Grid>
</Window>